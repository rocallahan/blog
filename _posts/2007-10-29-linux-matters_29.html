---
layout: "post"
title: "Linux Matters"
date: "2007-10-29 10:24:00 +0000"
categories: "Mozilla"
permalink: "/2007/10/linux-matters_29.html"
---
<div class="columns"><p>I've been reading <a href="http://lovesunix.net/blog/?p=189">some</a> <a href="http://nicubunu.blogspot.com/2007/10/what-if-linux-users-would-cease-their.html">dissastisfaction</a> with the state of Firefox and Gecko on Linux. I feel I should comment because for a couple of years I was Novell's "Firefox guy" and did significant work on Gecko/GNOME integration.<br/><p>I take exception to comments like:<br/><blockquote>However it geniunely seems that Mozilla does not care about Linux the slightest.</blockquote><br/>The truth is that during every development cycle we sink a ton of effort into making sure that Gecko and all its features work well on Linux. In 1.9 we've done lots of work to integrate with Pango, fix cairo-on-X issues, make sure &lt;video&gt; works, wrangle build-system and compiler issues, etc. If we didn't care about Linux, we'd just drop support for it. That would help us get Mac and Windows releases out faster, and after all they're where most users are. Fortunately we don't make decisions purely for economic reasons. I'd like to see people recognise that.<br/><p>Part of the problem is that people are using Gecko 1.8.1 which is over two years old now. We'll ship Gecko 1.9 soon which has a ton of good stuff for Linux users:<br/><ul><br/><li>Michael Ventnor (awesome volunteer contributor) has fixed a bunch of GTK theme bugs and turned on GTK themes for HTML form widgets --- very sexy. (MoCo is hiring him as an intern to carry on working on these and other issues during the summer.)<br/><li>Teune van Steege (another contributor) has implemented GTK theme support for tree headers, which fixes the most important remaining non-native-looking UI element.<br/><li>We've ripped out our own cross-platform drawing code and are now using cairo for everything. Along the way we've made a lot of contributions to cairo. We're trying really hard to be good community players here.<br/><li>We integrate nicely with Pango now, using it to shape all complex scripts and also Latin text in many situations. By tweaking <a href="http://kb.mozillazine.org/Browser.display.auto_quality_min_font_size">one pref</a> you can disable the non-Pango fast path and get Pango for all text.<br/><li>Thanks to Theppitak Karoonboonyanan and other contributors we use Pango line-breaking for scripts that have extraordinary line-breaking needs such as Thai, Lao, and Tibetan.<br/><li>Karl Tomlinson (MoCo) designed and implemented "windowless plugin" support for X so that Linux can have platform parity with Mac and Windows users when Adobe supports it in their Linux Flash player (or if swfdec beats them to it!).<br/><li>We've landed in 1.9 some of the GNOME integration work that I did for Novell, in particular <a href="http://www.freedesktop.org/wiki/Software/startup-notification">startup notification</a> support and <a href="http://www.freedesktop.org/wiki/Software/dbus">dbus</a>-based <a href="http://www.gnome.org/projects/NetworkManager/">NetworkManager</a> integration. (Some of the other work I did, like improved <a href="http://www.gnome.org/projects/gconf/">GConf</a> integration has still to land ... just needs someone to push it in.)<br/><li><strong>Update</strong> Aaron Leventhal (IBM) and many other contributors have done a ton of work to make Firefox and the entire Mozilla platform accessible on Linux. This includes helping out with Linux-specific accessibility infrastructure and assistive technologies such as Orca.<br/></ul><br/><p>There's definitely more we could do. I've been soliciting volunteers to implement RGBA translucent windows for X, for example, and it would be nice to support the GNOME print dialog. But I think we've made good progress.<br/><p>One observation is that the number of Mozilla developers who are Linux users has dropped quite a bit as many of us (including me) have switched to Macs. I think this is partly due to Apple's hardware and software being very good and partly due to the fact that because Apple is evil, you can virtualize Linux on Mac but not the other way around. No doubt this has impacted Linux support a little bit. I still think that Linux is ultimately very important to Mozilla because proprietary client platforms will always pose a threat to the open Internet; the client vendors will constantly be trying to find ways to extend their control into the network. (And of course an open Internet is crucial to the survival of open clients, which is one of the main reasons I do what I do.)<br/><p>Let me just address a few other complaints while I'm here:<br/><ul><br/><li><br/><blockquote>The list of things Firefox could do to improve integration with the underlying environment goes on and on</blockquote><br/>I'd like to see that list. Now that we have more heads, we might get some of those things done within MoCo, and I'd be more than happy to help other contributors get them done.<br/><li>We have done a lot of work on memory consumption, some with help from <a href="http://www.gnome.org/~federico/">Federico Mena-Quintero</a>. We know this is a big deal. We're getting better in this and other areas and we're going to keep getting better.<br/><li>Webkit is a good engine and getting it running in GNOME is a good thing, but be careful about comparing a two-year-old engine you use all the time (and hence see all the bugs of) with something that isn't quite there yet. Also, I would hate to see Apple with too much power over the free desktop ... keep options open.<br/><li><br/><blockquote><a href="http://cgwalters.livejournal.com/8713.html">WebKit ... happily uses GTK the way it was meant to be used instead of doing crappy hacks like cloning several instances of one widget and overloading its painting context.</a></blockquote><br/>I'm not sure if this person knows what they're talking about, but if the Webkit/GTK port is using real GTK widgets in Web pages, then either they're doing some wizardry that I don't understand or they're going to have serious problems rendering content like this:<br/><p><button style="width:100px;"><b>Hello</b></button><span style="position:relative;left:-100px;opacity:0.5;background-color:blue;white-space:pre;">                        </span><br/><p>(This demo might be mangled by feed readers etc.) <em>Even Webkit on Mac and IE on Windows don't use real native widgets.</em> I agree our theming approach on GTK is a crappy hack; I've been begging for years for a real GTK theme-drawing API we could use, like Mac and Windows provide.</div><br/><p><strong>Update</strong> Here's a screenshot of the Bugzilla query page in Firefox 3 trunk using Clearlooks:<br/><div class="image"><img alt="Shiny Bugzilla" src="/assets/images/bugzilla-query-native-theme.png" width="957" height="714"/></div><br/><br/>
<div class='comments'><h2>Comments</h2>
<div class='comment'>
<div class='author'>Boris</div>
<div class='content'>It seems to me that there are two things being conflated here in the comments, and especially in the linked-to blog:<br>1)  Firefox integration with GNOME.  This has been getting a lot of work and getting better, as roc says.<br>2)  Gecko embedding as a gtk widget.  This hasn&#39;t been getting much work for years.  Not has Gecko embedding of any kind.  For a while some GNOME folks maintained gtkmozembed, but they seem to have stopped doing that, more or less.<br></div>
</div>
<div class='comment'>
<div class='author'>dustin</div>
<div class='content'>http://noodge.org/random/linuxsupport.png<br>This is what that button looks like in Firefox 2.0.latest.  I&#39;d be curious to know what it looks like in gecko 1.9<br></div>
</div>
<div class='comment'>
<div class='author'>Michael Ventnor</div>
<div class='content'>I can think of two mainstream complaints that we can easily fix for Fx 3:<br>a) Get rid of the shiny tab bar and use a natively constructed one<br>b) Use stock icons for the toolbar<br>Both can easily be fixed if/when browser/&#39;s winstripe is forked to a gnomestripe. Removal of the go and search buttons would also help since GNOME typically doesn&#39;t have buttons next to textfields that duplicate the behaviour of the Enter key. But we really, really, really need a gnomestripe directory under browser/themes/.<br></div>
</div>
<div class='comment'>
<div class='author'>Robert O'Callahan</div>
<div class='content'>clee: it renders the button with the native *look*, sure, but it&#39;s not implemented as a *real native widget*. Just like we render buttons with the GTK+ look, but they&#39;re not real GTK+ native widgets.<br>Hmm, looks like my demo triggers some kind of Webkit bug rendering that span. Maybe something to do with the columns.<br>Igor:<br>&gt; I&#39;m seeing Mozilla actually releasing Firefox<br>&gt; *late* for Linux(and other Unix-like systems)<br>When have we ever done that?<br>Egor: interesting. Sounds like the sort of thing that might go upstream.<br></div>
</div>
<div class='comment'>
<div class='author'>Robert O'Callahan</div>
<div class='content'>Per: I don&#39;t know what Ubuntu has done. If they&#39;re just added a custom Firefox theme, that doesn&#39;t really need to go upstream.<br>Richard: &quot;toasted&quot;? He didn&#39;t address this post directly at all. He just listed some good things about Webkit/GTK+ ... which is fine, they are good things.<br>Benjamin: OK, I did miss that. Maybe Blizzard can help us get these issues nailed down and fixed.<br></div>
</div>
<div class='comment'>
<div class='author'>Per Thulin</div>
<div class='content'>We know it takes effort to target another platform, we know you care, and we appreciate it. I think part of what makes it look like you&#39;re not is that when reading your blogs, it often feels like your work revolves around Win/Mac, with Linux hanging on the side.<br>On the topic of Linux integration, have you looked at what Ubuntu has done in the latest release? Add-ons and extensions (Flash included) are handled with the package manager, and I downloaded an Ubuntu Firefox theme pack, and when turned on it sure looks a lot more native. I&#39;m sure someone put down a lot of work on this -- is anything going back upstream?<br>I&#39;ve been excited of Firefox 3 for a long time now, it sure looks good. I esp. like how you integrate more with underlying infrastructure. Keep it up!<br></div>
</div>
<div class='comment'>
<div class='author'>Igor</div>
<div class='content'>We are talking about this blog post:<br>http://blog.mozilla.com/faaborg/2007/10/10/the-firefox-3-visual-refresh-system-integration/<br>Where a Mozilla guy sadly totally forgot about Linux platform...<br>I&#39;m seeing Mozilla actually releasing Firefox *late* for Linux(and other Unix-like systems), just like Azureus people just done.<br></div>
</div>
<div class='comment'>
<div class='author'>Robert O'Callahan</div>
<div class='content'>Sounds good to me!<br></div>
</div>
<div class='comment'>
<div class='author'>clee</div>
<div class='content'>It&#39;s worth pointing out that WebKit on Leopard does in fact render that button using native widgets (but seems to be confused as to where it should put the blue background for the span element following it).<br>http://c133.org/img/native_hello.png<br></div>
</div>
<div class='comment'>
<div class='author'>Benjamin Otte</div>
<div class='content'>I think what you are missing about Linux is not integrating the application with the desktop. That is your problem on Windows and OS X, where people are used to download a bundle that they can drop into their applications folder.<br>What you are missing about Linux is the Linux way. It&#39;s hard to integrate Mozilla (or even Mozilla technology) into other applications, because Mozilla doesn&#39;t ship libraries that are usable. Looking at Webkit-Gtk, it seems there&#39;s a lot of people very excited about the ability to have a widget for doing HTML and AJAX that just works. Also in other places, Mozilla works different than Linux applications do. As an example, I cannot easily build a Swfdec Mozilla plugin and have it just work. Why not? Well, there is both no development headers to link it against (Swfdec packages these headers themselves) and there is no place to install it in, because every Mozilla app wants their own directory.<br>Anyway, I don&#39;t wanna list bugs here. I just wanna make the statement that using Mozilla for development feels different from all the other things I&#39;m using on Linux. It&#39;s just different.<br></div>
</div>
<div class='comment'>
<div class='author'>Egor Pelevin</div>
<div class='content'>@Robert<br>Ubuntu folks implemented a custom plugin finder service, which allows to install packaged plugins (e.g. Flash) with their package manager. I&#39;m not sure this can go upstream though, keeping in mind that there are different package managers in Linux.<br>Also they redirected &#39;Get Extensions&#39; link from Tools -&gt; Add-ons to their own list of pre-packaged extensions. This sounds like a bad idea.<br></div>
</div>
<div class='comment'>
<div class='author'>Aaron Leventhal</div>
<div class='content'>Another item for your list:<br>* We&#39;ve done a *ton* of work on making Firefox and the entire Mozilla platform accessible on Linux. This includes helping out with Linux-specific accessibility infrastructure and assistive technologies such as Orca.<br></div>
</div>
<div class='comment'>
<div class='author'>Richard Weber</div>
<div class='content'>Hey, you might want to check out this webkit guy&#39;s blog, he just toasted you on most points<br>http://www.atoker.com/blog/2007/10/29/gtk-matters/<br></div>
</div>
<div class='comment'>
<div class='author'>Jeff Walden</div>
<div class='content'>I could be wrong -- I&#39;ve not tried it out -- but none of the existing screenshots on the main hacker&#39;s blog contain any in-web-content form elements.  Appearances suggest that part of the port may not have been completed yet.  I expect to be vociferously corrected with screenshots if my induction is incorrect.<br>I should also note I&#39;m one of the Mac heathens using it because I can then use everything else.  I&#39;m not sure whether, given the option, I&#39;d use Linux over OS X; I use it now because 1) I don&#39;t have any choice if I want to be able to use everything without rebooting, and 2) I *really really* like being able to just download random pre-compiled third-party software from websites and be able to escape the walled garden of my distro&#39;s repositories.  All that said, there are enough gratuitous differences from everything else, and there are things I&#39;ve grown to love in GNOME that aren&#39;t in OS X (the time/date widget drops down into a calendar, for one -- it&#39;s *unconscionable* that nobody else I&#39;ve used does this yet), that I&#39;d probably switch back if I could.<br></div>
</div>

</div>